# Docker é…ç½®æ–‡ä»¶è¯´æ˜

## ğŸ“ åˆ›å»ºçš„æ–‡ä»¶æ¸…å•

### æ ¸å¿ƒé…ç½®æ–‡ä»¶

#### 1. `docker-compose.yml`
Docker Compose ä¸»é…ç½®æ–‡ä»¶ï¼Œå®šä¹‰äº†ä¸‰ä¸ªæœåŠ¡ï¼š
- **mysql**: MySQL 8.0 æ•°æ®åº“
- **redis**: Redis 7 ç¼“å­˜
- **backend**: Go åç«¯åº”ç”¨

**ç‰¹æ€§**:
- è‡ªåŠ¨å¥åº·æ£€æŸ¥
- æ•°æ®æŒä¹…åŒ–ï¼ˆvolumesï¼‰
- ç½‘ç»œéš”ç¦»
- è‡ªåŠ¨åŠ è½½åˆå§‹åŒ–è„šæœ¬

#### 2. `Dockerfile`
åç«¯åº”ç”¨çš„ Docker é•œåƒæ„å»ºæ–‡ä»¶

**ç‰¹æ€§**:
- å¤šé˜¶æ®µæ„å»ºï¼ˆå‡å°é•œåƒä½“ç§¯ï¼‰
- ä½¿ç”¨ Alpine Linuxï¼ˆè½»é‡çº§ï¼‰
- è‡ªåŠ¨ç¼–è¯‘ Go åº”ç”¨

#### 3. `.dockerignore`
Docker æ„å»ºæ—¶å¿½ç•¥çš„æ–‡ä»¶åˆ—è¡¨

**ä½œç”¨**:
- å‡å°æ„å»ºä¸Šä¸‹æ–‡å¤§å°
- åŠ å¿«æ„å»ºé€Ÿåº¦
- æ’é™¤ä¸å¿…è¦çš„æ–‡ä»¶

### é…ç½®æ–‡ä»¶

#### 4. `configs/config.docker.yaml`
Docker ç¯å¢ƒä¸“ç”¨é…ç½®æ–‡ä»¶

**ç”¨é€”**:
- é€‚é… Docker ç½‘ç»œç¯å¢ƒ
- æœåŠ¡åæ›¿ä»£ localhost
- å®¹å™¨é—´é€šä¿¡é…ç½®

#### 5. `env.example`
ç¯å¢ƒå˜é‡ç¤ºä¾‹æ–‡ä»¶

**ç”¨é€”**:
- æä¾›é…ç½®æ¨¡æ¿
- æ•æ„Ÿä¿¡æ¯é…ç½®å‚è€ƒ
- å¿«é€Ÿå¤åˆ¶ä¸º .env ä½¿ç”¨

### è„šæœ¬å’Œå·¥å…·

#### 6. `docker-start.sh`
äº¤äº’å¼ Docker å¯åŠ¨è„šæœ¬

**åŠŸèƒ½**:
- ä¸€é”®å¯åŠ¨æ•°æ®åº“
- ä¸€é”®å¯åŠ¨æ‰€æœ‰æœåŠ¡
- æŸ¥çœ‹æœåŠ¡çŠ¶æ€
- æŸ¥çœ‹æ—¥å¿—
- åœæ­¢/åˆ é™¤æœåŠ¡

**ä½¿ç”¨**:
```bash
./docker-start.sh
```

#### 7. `Makefile` (å·²æ›´æ–°)
æ·»åŠ äº† Docker ç›¸å…³çš„ make å‘½ä»¤

**æ–°å¢å‘½ä»¤**:
- `make docker-up`: å¯åŠ¨æ‰€æœ‰æœåŠ¡
- `make docker-db`: å¯åŠ¨æ•°æ®åº“
- `make docker-logs`: æŸ¥çœ‹æ—¥å¿—
- `make docker-clean`: æ¸…ç†å®¹å™¨
- `make help`: æŸ¥çœ‹æ‰€æœ‰å‘½ä»¤

### æ–‡æ¡£

#### 8. `DOCKER.md`
å®Œæ•´çš„ Docker ä½¿ç”¨æ–‡æ¡£ï¼ˆçº¦ 200 è¡Œï¼‰

**åŒ…å«å†…å®¹**:
- å¿«é€Ÿå¼€å§‹æŒ‡å—
- é…ç½®è¯´æ˜
- å¸¸ç”¨å‘½ä»¤å‚è€ƒ
- æ•…éšœæ’æŸ¥
- æ€§èƒ½ä¼˜åŒ–å»ºè®®
- ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å»ºè®®

#### 9. `DOCKER_QUICKSTART.md`
å¿«é€Ÿå…¥é—¨æŒ‡å—

**åŒ…å«å†…å®¹**:
- ä¸€åˆ†é’Ÿå¿«é€Ÿå¯åŠ¨
- é»˜è®¤é…ç½®è¯´æ˜
- å¸¸ç”¨åœºæ™¯ç¤ºä¾‹
- å¸¸è§é—®é¢˜è§£ç­”

#### 10. `README.md` (å·²æ›´æ–°)
æ·»åŠ äº† Docker éƒ¨ç½²ç›¸å…³çš„å¿«é€Ÿå¼€å§‹è¯´æ˜

## ğŸ¯ ä½¿ç”¨å»ºè®®

### æ–°æ‰‹æ¨è
1. é˜…è¯» `DOCKER_QUICKSTART.md`
2. è¿è¡Œ `./docker-start.sh` é€‰æ‹©é€‰é¡¹ 1
3. æœ¬åœ°å¼€å‘åç«¯

### å¼€å‘æ¨è
1. ä½¿ç”¨ `make docker-db` å¯åŠ¨æ•°æ®åº“
2. åœ¨ IDE ä¸­è°ƒè¯•ä»£ç 
3. ä½¿ç”¨ `make docker-logs` æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—

### æµ‹è¯•æ¨è
1. ä½¿ç”¨ `make docker-up` å¯åŠ¨å®Œæ•´ç¯å¢ƒ
2. æµ‹è¯•å®Œæ•´çš„éƒ¨ç½²æµç¨‹
3. ä½¿ç”¨ `make docker-clean` æ¸…ç†ç¯å¢ƒ

### ç”Ÿäº§æ¨è
1. é˜…è¯» `DOCKER.md` ä¸­çš„ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å»ºè®®
2. ä¿®æ”¹æ‰€æœ‰é»˜è®¤å¯†ç 
3. é…ç½®æ•°æ®å¤‡ä»½ç­–ç•¥
4. ä½¿ç”¨ HTTPS å’Œåå‘ä»£ç†

## ğŸ“Š æ–‡ä»¶å…³ç³»å›¾

```
docker-start.sh  â”€â”€â”
Makefile        â”€â”€â”¼â”€â”€> docker-compose.yml â”€â”€â”¬â”€â”€> Dockerfile
                  â”‚                          â”‚
                  â”‚                          â”œâ”€â”€> configs/config.docker.yaml
                  â”‚                          â”‚
                  â”‚                          â””â”€â”€> scripts/migration/*.sql
                  â”‚
                  â””â”€â”€> env.example â”€â”€> .env (ç”¨æˆ·åˆ›å»º)

æ–‡æ¡£å±‚:
  README.md â”€â”€> DOCKER_QUICKSTART.md â”€â”€> DOCKER.md
```

## ğŸ”„ å¿«é€Ÿå‘½ä»¤å¯¹ç…§è¡¨

| æ“ä½œ | docker-compose | Makefile | è„šæœ¬ |
|------|----------------|----------|------|
| å¯åŠ¨æ•°æ®åº“ | `docker-compose up -d mysql redis` | `make docker-db` | `./docker-start.sh` (é€‰é¡¹1) |
| å¯åŠ¨æ‰€æœ‰æœåŠ¡ | `docker-compose up -d` | `make docker-up` | `./docker-start.sh` (é€‰é¡¹2) |
| æŸ¥çœ‹çŠ¶æ€ | `docker-compose ps` | `make docker-ps` | `./docker-start.sh` (é€‰é¡¹5) |
| æŸ¥çœ‹æ—¥å¿— | `docker-compose logs -f` | `make docker-logs` | `./docker-start.sh` (é€‰é¡¹6) |
| åœæ­¢æœåŠ¡ | `docker-compose stop` | `make docker-down` | `./docker-start.sh` (é€‰é¡¹3) |
| æ¸…ç†æ•°æ® | `docker-compose down -v` | `make docker-clean` | `./docker-start.sh` (é€‰é¡¹4) |

## âœ… éªŒè¯å®‰è£…

è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯ Docker ç¯å¢ƒæ˜¯å¦æ­£å¸¸ï¼š

```bash
# 1. å¯åŠ¨æ•°æ®åº“
make docker-db

# 2. ç­‰å¾… 10 ç§’è®©æœåŠ¡å®Œå…¨å¯åŠ¨

# 3. æ£€æŸ¥æœåŠ¡çŠ¶æ€
make docker-ps

# 4. æµ‹è¯• MySQL è¿æ¥
mysql -h 127.0.0.1 -P 3306 -u codeya_user -pcodeya_pass_2024 -e "SHOW DATABASES;"

# 5. æµ‹è¯• Redis è¿æ¥
redis-cli -h 127.0.0.1 -p 6379 -a codeya_redis_2024 PING

# åº”è¯¥çœ‹åˆ° "PONG" å“åº”
```

## ğŸ“ å­¦ä¹ è·¯å¾„

1. **å…¥é—¨** (5åˆ†é’Ÿ)
   - é˜…è¯» `DOCKER_QUICKSTART.md`
   - è¿è¡Œ `./docker-start.sh`

2. **å¼€å‘** (10åˆ†é’Ÿ)
   - å¯åŠ¨æ•°æ®åº“: `make docker-db`
   - æœ¬åœ°è¿è¡Œåç«¯: `make run`
   - æµ‹è¯• API

3. **æ·±å…¥** (30åˆ†é’Ÿ)
   - é˜…è¯» `DOCKER.md`
   - äº†è§£é…ç½®ç»†èŠ‚
   - å­¦ä¹ æ•…éšœæ’æŸ¥

4. **ç”Ÿäº§** (1å°æ—¶)
   - ä¿®æ”¹é»˜è®¤é…ç½®
   - è®¾ç½®æ•°æ®å¤‡ä»½
   - é…ç½®ç›‘æ§å’Œæ—¥å¿—

## ğŸ†˜ è·å–å¸®åŠ©

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. æŸ¥çœ‹ `DOCKER_QUICKSTART.md` çš„å¸¸è§é—®é¢˜éƒ¨åˆ†
2. æŸ¥çœ‹ `DOCKER.md` çš„æ•…éšœæ’æŸ¥éƒ¨åˆ†
3. è¿è¡Œ `make help` æŸ¥çœ‹æ‰€æœ‰å¯ç”¨å‘½ä»¤
4. æŸ¥çœ‹æ—¥å¿—: `docker-compose logs -f`

