<view class="game-container">
  <!-- æ¸¸æˆå¤´éƒ¨ä¿¡æ¯ -->
  <view class="game-header">
    <view class="score-container">
      <text class="score-label">å¾—åˆ†:</text>
      <text class="score-value">{{score}}</text>
    </view>
    <view class="time-container">
      <text class="time-label">æ—¶é—´:</text>
      <text class="time-value">{{timeLeft}}ç§’</text>
    </view>
    <view class="moves-container">
      <text class="moves-label">æ­¥æ•°:</text>
      <text class="moves-value">{{moves}}</text>
    </view>
  </view>

  <!-- æ¸¸æˆå¼€å§‹å‰çš„ä»‹ç»ç•Œé¢ -->
  <view class="intro-screen" wx:if="{{gameState === 'intro'}}">
    <view class="intro-content">
      <text class="intro-title">è¡¨æƒ…æ¶ˆæ¶ˆä¹</text>
      <text class="intro-level">å…³å¡ {{currentLevel + 1}}</text>
      <text class="intro-description">åŒ¹é…ç›¸åŒçš„è¡¨æƒ…ï¼Œæ¶ˆé™¤æ‰€æœ‰æ–¹å—ï¼</text>
      <text class="intro-feature">ğŸ¦† ğŸ¶ ğŸ± ä¸°å¯Œçš„åŠ¨ç‰©è¡¨æƒ…ç­‰ä½ æ¥é…å¯¹ï¼</text>
      <text class="intro-rules">æ¸¸æˆè§„åˆ™:</text>
      <text class="intro-rule-item">1. ç‚¹å‡»ä¸¤ä¸ªç›¸åŒçš„è¡¨æƒ…è¿›è¡ŒåŒ¹é…</text>
      <text class="intro-rule-item">2. åŒ¹é…æˆåŠŸçš„è¡¨æƒ…ä¼šæ¶ˆå¤±</text>
      <text class="intro-rule-item">3. åœ¨è§„å®šæ—¶é—´å†…æ¶ˆé™¤æ‰€æœ‰è¡¨æƒ…</text>
      <text class="intro-rule-item">4. æ­¥æ•°è¶Šå°‘ï¼Œå¾—åˆ†è¶Šé«˜</text>
      <view class="intro-level-info">
        <text class="level-info-item">ç½‘æ ¼å¤§å°: {{levels[currentLevel].gridSize}}x{{levels[currentLevel].gridSize}}</text>
        <text class="level-info-item">æ—¶é—´é™åˆ¶: {{levels[currentLevel].timeLimit}}ç§’</text>
        <text class="level-info-item">åŸºç¡€å¥–åŠ±: {{levels[currentLevel].reward}}å¨é¸­å±</text>
      </view>
      <text class="intro-cost">æœ¬æ¬¡æ¸¸æˆå°†æ¶ˆè€— {{levels[currentLevel].costPoints}} ç§¯åˆ†</text>
      <view class="intro-buttons">
        <button class="start-button" bindtap="startGame">å¼€å§‹æ¸¸æˆ</button>
        <button class="level-select-button" bindtap="showLevelSelect">é€‰æ‹©å…³å¡</button>
      </view>
    </view>
  </view>

  <!-- å…³å¡é€‰æ‹©ç•Œé¢ -->
  <view class="level-select-screen" wx:if="{{gameState === 'level-select'}}">
    <view class="level-select-content">
      <text class="level-select-title">é€‰æ‹©å…³å¡</text>
      <view class="levels-grid">
        <view 
          wx:for="{{levels}}" 
          wx:key="index" 
          class="level-item {{index < unlockedLevels ? 'unlocked' : 'locked'}}"
          bindtap="selectLevel"
          data-level="{{index}}"
        >
          <text class="level-number">{{index + 1}}</text>
          <view class="level-details" wx:if="{{index < unlockedLevels}}">
            <text class="level-grid-size">{{item.gridSize}}x{{item.gridSize}}</text>
            <text class="level-time">{{item.timeLimit}}ç§’</text>
          </view>
          <view class="level-lock" wx:else>
            <text class="lock-icon">ğŸ”’</text>
          </view>
          <view class="level-progress" wx:if="{{levelProgress['level_' + index]}}">
            <text class="level-high-score">æœ€é«˜åˆ†: {{levelProgress['level_' + index].highScore}}</text>
            <text class="level-best-moves">æœ€å°‘æ­¥æ•°: {{levelProgress['level_' + index].bestMoves}}</text>
          </view>
        </view>
      </view>
      <button class="back-button" bindtap="exitGame">è¿”å›</button>
    </view>
  </view>

  <!-- æ¸¸æˆä¸»ç•Œé¢ -->
  <view class="game-board" wx:if="{{gameState === 'playing'}}">
    <view class="emoji-grid" style="grid-template-columns: repeat({{gridSize}}, 1fr);">
      <view 
        wx:for="{{emojiGrid}}" 
        wx:key="index" 
        class="emoji-cell {{item.selected ? 'selected' : ''}} {{item.matched ? 'matched' : ''}} {{item.empty ? 'empty' : ''}}"
        bindtap="onEmojiTap"
        data-index="{{index}}"
      >
        <text class="emoji" wx:if="{{!item.matched && !item.empty}}">{{item.emoji}}</text>
      </view>
    </view>
  </view>

  <!-- æ¸¸æˆç»“æŸç•Œé¢ -->
  <view class="game-over-screen" wx:if="{{gameState === 'gameOver'}}">
    <view class="game-over-content">
      <text class="game-over-title">{{gameWon ? 'æ­å–œè¿‡å…³ï¼' : 'æ¸¸æˆç»“æŸ'}}</text>
      <text class="game-over-emoji">{{gameWon ? 'ğŸ‰ ğŸ¦† ğŸŠ' : 'ğŸ˜¢ ğŸ¶ ğŸ˜¢'}}</text>
      <text class="game-over-level">å…³å¡ {{currentLevel + 1}}</text>
      <text class="game-over-score">æœ€ç»ˆå¾—åˆ†: {{score}}</text>
      <text class="game-over-moves">ä½¿ç”¨æ­¥æ•°: {{moves}}</text>
      <text class="game-over-time">å‰©ä½™æ—¶é—´: {{timeLeft}}ç§’</text>
      <text class="game-over-reward" wx:if="{{gameWon}}">è·å¾—å¥–åŠ±: {{reward}}å¨é¸­å± ğŸ’©</text>
      <view class="game-over-buttons">
        <button class="restart-button" bindtap="restartGame">å†æ¥ä¸€å±€</button>
        <button class="level-select-button" bindtap="backToLevelSelect">é€‰æ‹©å…³å¡</button>
        <button class="exit-button" bindtap="exitGame">é€€å‡ºæ¸¸æˆ</button>
      </view>
    </view>
  </view>

  <!-- åº•éƒ¨ç§¯åˆ†æ˜¾ç¤º -->
  <view class="points-info">
    <view class="points-display">
      <text class="points-icon">ğŸª™</text>
      <text class="points-value">{{totalPoints}}</text>
      <text class="points-label">ç§¯åˆ†</text>
    </view>
    <view class="poop-display">
      <text class="poop-icon">ğŸ’©</text>
      <text class="poop-value">{{totalPoop}}</text>
      <text class="poop-label">é¸­å±</text>
    </view>
  </view>
</view> 